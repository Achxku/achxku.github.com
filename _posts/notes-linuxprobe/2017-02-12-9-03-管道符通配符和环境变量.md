---
layout: post
title: "管道符、重定向与环境变量"
date: 2017-2-12 
description: 管道符、重定向与环境变量
tags: 
 - linux
 - RHCE 

---

# 管道符、重定向与环境变量

**概述**
- 输入输出重定向
- 管道命令符
- 通配符
- 常见转义符
- 环境变量


----------

## 输入输出重定向

- 输入重定向：将文件内容导入到命令中
- 输出重定向：将原本要输出到屏幕的数据信息写入到指定的文件中


- 标准输入
- 标准正确输出
- 标准错误输出


- 清空写入
- 追加写入


> 标准输入(**STDIN**，文件描述符为 0 )：默认从键盘输入，为 0 时表示是从其他文件或命令的输出。
> 
> 标准输出(**STDOUT**，文件描述符为 1 )：默认输出到屏幕，为 1 时表示是文件。
> 
> 错误输出(**STDERR**，文件描述符为 2 )：默认输出到屏幕，为 2 时表示是文件。

```
ls -l linuxprobe  # 标准正确输出

ls -l xxxxx  # 标准错误输出
```

输入重定向：

符号 | 作用
-----|-----
命令 < 文件 | 将文件作为命令的标准输入
命令 << 分界符 | 从标准输入中持续读入，直到再次遇到分界符才停止
命令 < 文件1 > 文件2 | 将文件 1 作为命令的标准输入，并将标准输出到文件 2

```
wc -l < /etc/passwd
cat >>hello.sh<< "EOF"

```

输出重定向符:

符号	|作用
----|-----
命令 > 文件	|将标准输出重定向到一个文件中（清空原有文件的数据）
命令 2> 文件	|将错误输出重定向到一个文件中（清空原有文件的数据）
命令 >> 文件	|将标准输出重定向到一个文件中（追加到原有内容的后面）
命令 2>> 文件	|将错误准输出重定向到一个文件中（追加到原有内容的后面）
命令 >> 文件 2>&1 或 命令 &>> 文件 |	将标准输出与错误输出共同写入到文件中（追加到原有内容的后面）

```
man bash > readme.txt
more readme.txt
```

清空写入与追加写入

```
echo "welcome to here" >readme.txt
cat readme.txt
echo "i like linux" >>readme.txt
cat readme.txe

```

不同的命令标准输出和错误输出:

```
ls -l readme.txt 
ls -l readme.txt > stdout.txt
ls -l readme.txt 2> stderr.txt

```

----------

## 管道命令符

将前一个命令原本要输出到屏幕的数据当作是后一个命令的标准输入

```
grep /sbin/nologin /etc/passwd | wc -l
ls -l /etc/ | more
echo "linuxprobe" | passwd --stdin root
echo "Content" | mail -s "Subject" linuxprobe
```

```
mail -s "Readme" root@linuxprobe.com << over
> I think linux is very practical
> I hope to learn more
> can you teach me ?
> over
```

```
cat << EOF >hello.sh
>#!/bin/bash
>echo "i like linux"
>EOF
```

----------

##  命令行的通配符

通配符：通用的匹配信息的符号

`*` ： 匹配 0 个或任意多个字符

`？` ： 匹配 1 个字符

`[1-9]` : 匹配 [ ] 内的字符

`{1..4}` : 匹配 {} 内的字符

```
ls -l /dev/sda*
ls -l /dev/sda?
ls -l /dev/sda??
ls -l /dev/sda{1,3}
```

----------

## 常用的转义字符

`\` : 反斜杠

` ' ' ` : 单引号，取消所有特殊字符的特殊含义

` " " ` : 双引号，保留变量属性不变

` ` ` : 反引号，返回其包含的命令的执行结果

```
Price=5
echo "price is $Price"
echo "price is \$$Price"
echo `date`
```

----------

## 重要的环境变量

变量是计算机系统中用于保存可变值的数据类型


环境变量是用来指定系统运行环境的一些参数

命令执行过程：
- 判断用户是否以绝对路径或相对路径的方式输入命令（如/bin/ls），如果是的话则直接执行。
- 检查用户输入的命令是否为“别名命令”
- 由SHELL解释器（Bash）来判断用户输入的是内部命令还是外部命令，内部命令是解释器内部的指令，会被直接的执行
- 系统在多个路径中查找用户输入的命令文件

用 alias 命令来创建自己的命令别名，格式为: “ alias 别名=命令 ”

用 unalias 命令，格式为： “unalias 别名”

用 “type 命令名称” 来手工判断是内部命令还是外部命令

命令搜索路径变量：PATH

> 为什么不能在$PATH中添加进当前目录 (.) 那?

> 答案:虽然将 $PATH 变量添加了当前目录 (.) 会在一些情况让用户免去输入命令所在路径的麻烦，但如果黑客在比较常用的公共目录 /tmp 中存放了一个名为 "ls" 或 "cd" 的同名木马文件，那么用户就极有可能错误的执行了。

>接手了一台Linux系统后一定会在执行命令前先检查下PATH变量中是否有可疑的目录

使用 env 命令来查看到linux系统中所有的环境变量

变量名称	|作用
--------|-----
HOME	|用户的主目录（即家目录）。
SHELL	|用户在使用的SHELL解释器名称。
HISTSIZE	|历史命令记录条数。
HISTFILESIZE	|历史命令记录条数。
MAIL	|邮件信箱文件保存路径。
LANG	|系统语言、语系名称。
RANDOM	|生成一个随机数字。
PS1	|bash 解释器的提示符。
PATH	|定义解释器搜索用户执行命令的路径。
EDITOR	|用户默认的文本编辑器。

变量是由固定的变量名与用户或系统设置的变量值两部分组成的

使用 export 命令将其提升为全局变量


----------

## 本章命令汇总

`< ` 命令: 输入重定向

`<<` 命令: 分界符

`>` 命令: 输出重定向（覆盖原有的内容） 

`>>` 命令：输出重定向（追加到文件原来内容的后面）

`2>` 命令：错误输出重定向

`2>>` 命令：错误输出重定向（追加到原来文件内容的后面）

`&>` 命令：把正确输出和错误输出输出到同一文件中，（混合单打）

`&>>`

`|` 命令：管道符

`*  ? [] {}` : 通配符

`\` : 转义字符

重要的环境变量：

```
HOME  SHELL HISTSIZE  MAIL  LANG  RANDOM  PS1  PATH  EDITOR
```

----------

## 作业

1. 将 ls 命令正常输出信息追加写入到 error.txt 文件中的命令是？

答案:ls >> error.txt

2. 现在您能简述下管道符的作用吗？

答案:将左面（前面）命令的输出值作为右面（后面）命令的输入值以便进一步处理信息。

3. 请问 bash 解释器通配符中星号（*）代表几个字符？

答案:零个或多个。

4. PATH 变量的作用是？

答案:设定解释器搜索执行命令的路径。

5. 请问什么命令能够将名称为LINUX的一般变量转换成全局变量？

答案:执行 export LINUX 命令即可。

6. 若想要将整个字符串中所有的字符都转义成纯文字数据，不允许变量生效的话怎么实现？

答案：需要使用转义符中的单引号，将整个字符串信息括起来。


----------

2017-2-12 by Achxku









